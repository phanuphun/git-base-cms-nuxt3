---
title: EF Core ขั้นตอนการกำหนดความสัมพันธ์ 1:N
date: 2024/10/31
tool: ASPDotNetCore
tag: EF Core
img: ""
path: efCore1-N
---

**ฝั่ง Mony**
1. สร้าง Field(Property) ขึ้นมาเพื่อรองรับ FK ของอีกตารางเช่น CategoryId จะเก็บเปนประเภทอะไรก็แล้วแต่
2. สร้าง Navigation Property เพื่ออ้างอิง FK ที่เราพึ่งสร้างก่อนหน้านี้ โดยใน Property ที่อ้างอิงนี้ต้องอ้างอิงไปยังคลาสที่เราจะทำ FK ให้ถูกต้อง **พร้อมกับระบุ Data Annotation `[ForeignKey("FkField")]` ใส่เข้าไปที่ Navigation Propery ตัวนี้ด้วย**

**ฝั่ง One**

3. สร้าง Navigation Property ที่จะอ้างอิงไปทางฝั่งของ Mony โดยในส่วนนี้จะสร้างเป็น `ICollection<T>` เพื่อรองรับความสัมพันธ์จากอีกฝั่ง ว่าฝั่งนี้สามารถมีฝั่ง Mony ได้มวกกว่า 1 (1:N)
4. ใช้คำสั่งในการ Migration ไปยังฐานข้อมูล

**เพิ่มเติม**
- ความสัมพันธ์แบบ 1:N ไม่จำเป็นต้องกำหนด Fluent API ที่ ContextDb เพราะว่า EF Core สามารถรู้ได้เลยว่าความสัมพันธ์แบบ 1:N จากการที่เรากำหนด FK และ Navigation Property เอาไว้แล้ว

- ขณะเดัยวกันความสัมพันธ์แบบ 1:1 จำเป็นต้องกำหนดว่าฝั่งไหนจะเป็นผู้ถือ FK และเป็นความสัมพันธ์ที่ต้องการความชัดเจน ทำให้ EF Core ไม่สามารถระบุได้ชัดเจน จึงต้องมากำหนด Fluent API ที่ ContextDb อีกที
